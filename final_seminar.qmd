---
title: "Bivariate Outcome Small Area Estimation using Bayesian Hierarchical Models"
subtitle: "A Methodological Framework for Improved Precision and Efficiency"
bibliography: ref.bib
format:
  anu-light-revealjs:
    width: 1920
    height: 1080
    chalkboard: false
    auto-stretch: false
    slide-level: 3
    html-math-method: katex
    navigation-mode: vertical
    fig-cap-location: bottom
    tbl-cap-location: bottom
    scrollable: true
number-sections: true
number-depth: 3
author:
  - name: "Mu Li"
  - name: "Supervised by"
  - name: "Dr. Bernard Baffour, Dr. Alice Richardson, Dr. Susanna Cramb"
institute: "School of Demography"
date: last-modified
date-format: "D[th] MMMM YYYY"
execute:
  freeze: auto
toc: true
toc-depth: 2
---


# Introduction

- **Overview of PhD Research**:
  - This research focuses on two distinct, but interconnected areas of study: spatial model and socio-economic status measurement.
  - The first part introduces a longitudinal socio-economic index to better capture changes over time, enhancing traditional measures which are typically static.
  - The second part addresses the use of advanced statistical models to improve disease mapping and small area estimation, particularly focusing on the challenges of data sparsity and bivariate outcomes.
  
- **Goal**: Contributions to public health and socio-economic analysis through statistical modeling.

# Part One: Constructing a Socio-Economic Index for Longitudinal Analysis

## Background and Socio-Economic Indices

- Composite indices are widely used in socio-economic research

To measure socio-economic status is a complex task, as it is a multidimensional concept that encompasses various aspects of life, such as income, education, occupation and house conditions [@Zagorski1986Demographic]. Constructing a composite index is a common approach to measure socio-economic status, as it can provide a single summary measure that captures the multidimensional nature of socio-economic status.

- Principal Component Analysis (PCA) is a common method to construct composite indices

When given multiple indicators of socio-economic status, PCA can be used to construct a composite index by providing a linear combination of the indicators that maximizes the variance of the data. The first principal component is often used as the composite index, as it captures the most variation in the data, where this variation is assumed to be related to socio-economic status [@Mazziotta2019Use].


## Historical Review of the SEIFA-IRSD

- The current recognized form of SEIFA first appeared in 1986 and has been updated every five years since then.

Five indices are produced from 1986 to 1996, where there were two different indices produced for urban and rural areas for measuring socio-economic advantage and disadvantage. ABS justifies this urban/rural split, citing significant structural differences between variables in urban and rural areas.

- The 2001 SEIFA replaced two indices with one, which was the IRSAD. And four indices were produced since then until 2021, which are IRSD, IRSAD, IEO and IER.

Among these indexes, the IRSD is regarded as the most established and widely used, as it encompasses all available variables that reflect or measure socio-economic disadvantage [@SEIFA2001]. Furthermore, the IRSD is recognized for its consistency, as it has maintained a nearly identical methodological approach and variables in its construction process across various periods [@SEIFA2001; @SEIFA2021].


### Variable Selection for IRSD

::: {.panel-tabset}

#### 2006

<div style="font-size: 0.5em;">

| **Dimension**     | **Variable** | **Loading** | **Variable Description** |
|:-----|:-----|:--|:-------------------------------------------------------------------|
| **Income**            | INC\_LOW              | -0.76       | % People with stated annual household equivalized income between \$13,000 and \$20,799 (approx. 2nd and 3rd deciles) |
| **Education**     | NOQUAL                | -0.76       | % People aged 15 years and over with no post-school qualifications |
|                   | NOSCHOOL              | -0.44       | % People aged 15 years and over who did not go to school |
| **Employment**    | UNEMPLOYED            | -0.7        | % People (in the labour force) unemployed |
| **Occupation**    | OCC\_LABOUR           | -0.76       | % Employed people classified as Labourers |
|                   | OCC\_DRIVERS          | -0.51       | % Employed people classified as Machinery Operators and Drivers |
|                   | OCC\_SERVICE\_L       | -0.44       | % Employed people classified as Low Skill Community and Personal Service Workers |
| **Housing**       | RENT\_SOCIAL          | -0.7        | % Households renting from a Government or Community organization |
|                   | LOWRENT               | -0.67       | % Households paying rent who pay less than \$120 per week (excluding \$0 per week) |
| **Miscellaneous** | NONET                 | -0.85       | % Occupied private dwellings with no Internet connection |
|                   | ONEPARENT             | -0.67       | % Families that are one-parent families with dependent offspring only |
|                   | DISABILITYU70         | -0.61       | % People aged under 70 who have a long-term health condition or disability and need assistance with core activities |
|                   | NOCAR                 | -0.57       | % Occupied private dwellings with no car |
|                   | INDIGENOUS            | -0.52       | % People who identified themselves as being Aboriginal and/or Torres Strait Islander origin |
|                   | OVERCROWD             | -0.52       | % Occupied private dwellings requiring one or more extra bedrooms (based on Canadian National Occupancy Standard) |
|                   | DIVORCED              | -0.51       | % People aged 15 years and over who are separated or divorced |
|                   | ENGLISHPOOR           | -0.33       | % People who do not speak English well |
| **Total Number** |             | **17**      |                           |

: List of Variable for Constructing IRSD 2006 {#tbl-IRSDloading06}

</div>


#### 2011

<div style="font-size: 0.5em;">

| **Dimension**     | **Variable** | **Loading** | **Variable Description** |
|:-----|:-----|:--|:-------------------------------------------------------------------|
| **Income**          | INC\_LOW             | -0.9        | % People with stated annual household equivalized income between \$1 and \$20,799 (approx. 1st and 2nd deciles) |
| **Education**   | NOYR12ORHIGHER       | -0.75       | % People aged 15 years and over whose highest level of education is Year 12 or lower, including Certificate I and II |
|                 | NOEDU                | -0.44       | % People aged 15 years and over who have no educational attainment |
| **Employment**  | UNEMPLOYED           | -0.74       | % People (in the labour force) unemployed |
| **Occupation**  | OCC\_LABOUR          | -0.75       | % Employed people classified as "labourers" |
|                 | OCC\_DRIVERS         | -0.52       | % Employed people classified as Machinery Operators and Drivers |
|                 | OCC\_SERVICE\_L      | -0.5        | % Employed people classified as Low Skill Community and Personal Service Workers |
| **Housing**     | LOWRENT              | -0.73       | % Occupied private dwellings paying rent less than \$166 per week (excluding \$0 per week) |
| **Miscellaneous** | CHILDJOBLESS       | -0.85       | % Families with children under 15 years of age who live with jobless parents |
|                 | NONET                | -0.81       | % Occupied private dwellings with no Internet connection |
|                 | ONEPARENT            | -0.71       | % One parent families with dependent offspring only |
|                 | DISABILITYU70        | -0.66       | % People aged under 70 who have a long-term health condition or disability and need assistance with core activities |
|                 | NOCAR                | -0.56       | % Occupied private dwellings with no car |
|                 | OVERCROWD            | -0.52       | % Occupied private dwellings requiring one or more extra bedrooms (based on Canadian National Occupancy Standard) |
|                 | SEP\_DIVORCED        | -0.54       | % People aged 15 years and over who are separated or divorced |
|                 | ENGLISHPOOR          | -0.34       | % People who do not speak English well |
| **Total Number** | | **16** | |

: List of Variable for Constructing IRSD 2011 {#tbl-IRSDloading11}

</div>

#### 2016

<div style="font-size: 0.5em;">

| **Dimension**     | **Variable** | **Loading** | **Variable Description** |
|:-----|:-----|:--|:-------------------------------------------------------------------|
| **Income**          | INC\_LOW             | -0.91       | % People with stated annual household equivalized income between \$1 and \$25,999 (approx. 1st and 2nd deciles) |
| **Education**   | NOYR12ORHIGHER       | -0.77       | % People aged 15 years and over whose highest level of education is Year 12 or lower, including Certificate I and II |
|                 | NOEDU                | -0.43       | % People aged 15 years and over who have no educational attainment |
| **Employment**  | UNEMPLOYED           | -0.75       | % People (in the labour force) unemployed |
| **Occupation**  | OCC\_LABOUR          | -0.74       | % Employed people classified as "labourers" |
|                 | OCC\_DRIVERS         | -0.54       | % Employed people classified as Machinery Operators and Drivers |
|                 | OCC\_SERVICE\_L      | -0.53       | % Employed people classified as Low Skill Community and Personal Service Workers |
| **Housing**     | LOWRENT              | -0.73       | % Occupied private dwellings paying rent less than \$215 per week (excluding \$0 per week) |
| **Miscellaneous** | CHILDJOBLESS       | -0.83       | % Families with children under 15 years of age who live with jobless parents |
|                 | NONET                | -0.79       | % Occupied private dwellings with no Internet connection |
|                 | ONEPARENT            | -0.67       | % One parent families with dependent offspring only |
|                 | DISABILITYU70        | -0.67       | % People aged under 70 who have a long-term health condition or disability and need assistance with core activities |
|                 | SEPDIVORCED          | -0.55       | % People aged 15 years and over who are separated or divorced |
|                 | NOCAR                | -0.49       | % Occupied private dwellings with no car |
|                 | OVERCROWD            | -0.46       | % Occupied private dwellings requiring one or more extra bedrooms (based on Canadian National Occupancy Standard) |
|                 | ENGLISHPOOR          | -0.3        | % People who do not speak English well |
| **Total Number** | | **16** | |

: List of Variable for Constructing IRSD 2016 {#tbl-IRSDloading16}

</div>

#### 2021

<div style="font-size: 0.5em;">

| **Dimension**     | **Variable** | **Loading** | **Variable Description** |
|:-----|:-----|:--|:-------------------------------------------------------------------|
| **Income**          | INC\_LOW             | -0.87       | % People with stated annual household equivalized income between \$1 and \$25,999 (approx. 1st and 2nd deciles) |
| **Education**   | NOYR12ORHIGHER       | -0.75       | % People aged 15 years and over whose highest level of education is Year 12 or lower, including Certificate I and II |
|                 | NOEDU                | -0.47       | % People aged 15 years and over who have no educational attainment |
| **Employment**  | UNEMPLOYED           | -0.68       | % People (in the labour force) unemployed |
| **Occupation**  | OCC\_LABOUR          | -0.74       | % Employed people classified as "labourers" |
|                 | OCC\_DRIVERS         | -0.51       | % Employed people classified as Machinery Operators and Drivers |
|                 | OCC\_SERVICE\_L      | -0.45       | % Employed people classified as Low Skill Community and Personal Service Workers |
| **Housing**     | LOWRENT              | -0.71       | % Occupied private dwellings paying rent less than \$250 per week (excluding \$0 per week) |
| **Miscellaneous** | CHILDJOBLESS       | -0.78       | % Families with children under 15 years of age who live with jobless parents |
|                 | DISABILITYU70        | -0.63       | % People aged under 70 who have a long-term health condition or disability and need assistance with core activities |
|                 | ONEPARENT            | -0.58       | % One parent families with dependent offspring only |
|                 | OVERCROWD            | -0.51       | % Occupied private dwellings requiring one or more extra bedrooms (based on Canadian National Occupancy Standard) |
|                 | SEPDIVORCED          | -0.51       | % People aged 15 years and over who are separated or divorced |
|                 | NOCAR                | -0.43       | % Occupied private dwellings with no car |
|                 | ENGLISHPOOR          | -0.35       | % People who do not speak English well |
| **Total Number** | | **15** | |

: List of Variable for Constructing IRSD 2021 {#tbl-IRSDloading21}

</div>


:::

**Remarks on Variable Selection**

- **Addition of Variables**
    - `CHILDJOBLESS` was added from 2011, which quantifies the percentage of families with children under age 15 and parents without employment

- **Removal of Variables**
    - `RENT_SOCIAL` was removed from 2011, since its skewed distribution and relatively high non-response rate made it less reliable as an indicator of socio-economic status.
    - `INDIGENOUS` was removed from 2011, as it was deemed to be a sensitive variable that could lead to complex interpretations issues.
    - `NONET` was removed from 2021, as it was removed from the Census data collection, since having a fixed Internet connection was no longer a reliable indicator of socio-economic status, as many people now use mobile devices and other ways to access the Internet.

- **Changes in Variable Definitions**
    - `NOQUAL` was changed to `NOYR12ORHIGHER`, `NOSCHOOL` was changed to `NOEDU` from 2011, to better reflect the educational attainment of the population.

- **Changes in Variable Reference Value**
    - `INC_LOW` and `LOWRENT` had their reference values changed in each period with no pattern (not uniform, not distribution-based, not inflation-adjusted), which makes it difficult to compare the index across different periods.

<div style="font-size: 0.65em;">

| **Wave** | **INC_LOW Reference Level**                                  | **LOWRENT Reference Level**                         |
|----------|--------------------------------------------------------------|-----------------------------------------------------|
| 2006     | Income between \$13,000 and \$20,799 (approx. 2nd and 3rd deciles) | Rent less than \$120 per week (excluding \$0 per week) |
| 2011     | Income between \$1 and \$20,799 (approx. 1st and 2nd deciles)  | Rent less than \$166 per week (excluding \$0 per week) |
| 2016     | Income between \$1 and \$25,999 (approx. 1st and 2nd deciles)  | Rent less than \$215 per week (excluding \$0 per week) |
| 2021     | Income between \$1 and \$25,999 (approx. 1st and 2nd deciles)  | Rent less than \$250 per week (excluding \$0 per week) |

: Reference Level of INC_LOW and LOWRENT in Different Waves {#tbl-IRSDref}

</div>


### Geographical Boundary Changes

- **Two systems of geographical boundaries in Australia**
    - **ASGC**: Australian Standard Geographical Classification before 2011
    - **ASGS**: Australian Statistical Geography Standard after 2011, updated every five year

- **SEIFA based on areal units**
    - **CD**: Census Collection District (ASGC) in 2006
    - **SA1**: Statistical Area Level 1 (ASGS) in 2011 - 2021
    - **Larger spatial units**: Population weighted average of CD/SA1

- **Exclusions of areas with rules**
    - **Non-residential and high non-response rates areas**: such as airports, ports, and military bases
    - **One more phrase of exclusions in 2011, 2016, 2021**: areas with less than 6 denominator in the calculation of the index

**Number of Valid Areas in Constructing Index**

When comparing the index, all index will be converted into the same geographical standard, which is SA2 ASGS 2021. The conversion process is done by population-weighted average provided by correspondence files from ABS [@SEIFACorrespondences]

<div style="font-size: 0.6em;">

| **Index**| **Geographical Standards** | **2006** | **2011** | **2016** | **2021** |
|:------:|:------:|:------:|:------:|:------:|:------:|
| **IRSD**       | CD ASGC06                  | 37448/38704 (96.75%)              |                                    |                                    |                                    |
|                | SA1 ASGC11                 |                                    | 52577/54508 (96.46%)              |                                    |                                    |
|                | SA1 ASGC16                 |                                    |                                    | 55028/57523 (95.66%)              |                                    |
|                | SA1 ASGC21                 |                                    |                                    |                                    | 59283/61845 (95.86%)              |
| **Converted**  | SA2 ASGC21                 | 2423/2473 (97.98%)                | 2355/2473 (95.23%)                | 2344/2473 (94.78%)                | 2312/2473 (93.49%)                |
| | | | | | |
| **L-IRSD**     | CD ASGC06                  | 37737/38704 (97.5%)               |                                    |                                    |                                    |
|                | SA2 ASGC11                 |                                    | 2123/2214 (95.89%)                |                                    |                                    |
|                | SA2 ASGC16                 |                                    |                                    | 2200/2310 (95.24%)                |                                    |
|                | SA2 ASGC21                 |                                    |                                    |                                    | 2372/2473 (95.92%)               |
| **Converted**  | SA2 ASGC21                 | 2392/2473 (96.72%)                | 2343/2473 (94.74%)                | 2347/2473 (94.9%)                | 2366/2473 (95.67%)               |

: Number of Valid Areas in Constructing IRSD and L-IRSD {#tbl-valid-areas}

</div>


### Loading of Variables in IRSD

```{r}
#| label: fig-loading
#| fig-cap: "Loading of Variables in IRSD"
#| fig.width: 10
#| fig.height: 5
#| fig.align: center
#| out.width: "100%"
#| echo: false         # Suppresses code display
#| warning: false      # Suppresses warnings
#| message: false      # Suppresses messages

# library packages
library(tidyverse)

# load data
SEIFA_Loading <- read_csv("data/IRSD_loading.csv") 

# graph 

SEIFA_Loading %>%
  pivot_longer(3:6,
               names_to = "Year",
               values_to = "Loading") %>%
  mutate(Variables = fct_reorder(Variables, Loading,
                                 .desc = TRUE, .na_rm = FALSE)) %>%
  ggplot() +
  geom_point(aes(x = Loading,
                 y = Variables,
                 fill = Year,
                 size = Year),
             alpha = 0.65,
             shape = 21,
             color = "black") +
  scale_size_manual(values = c("2006" = 3, 
                               "2011" = 4,
                               "2016" = 5,
                               "2021" = 6)) +
  scale_fill_brewer(palette = "YlOrRd") +
  labs(fill = "Census Year",
       size = "Census Year",
       x = "Loadings") +
  scale_x_reverse(limits = c(0,-1)) +
  theme_bw()
```


**Remarks**

- **Proportion of Variance Explained**
    - IRSD accounted for 39% of the variation among variables in 2006, changing to 44% in 2011, 43% in 2016, and 37% in 2021

- **Loading Trends**
    - Stability in the loadings of certain variables—such as `DISABILITYU70`, `SEPDIVORCED`, `ENGLISHPOOR`, `LOWRENT`, `NOYEAR12ORHIGHER`, `NOEDU`, `OCC_DRIVER`, and `OVERCROWD`
    - `CHILDJOBLESS` and `ONEPARENT` have decreasing loadings over time - may be linked to changing societal attitudes towards marriage and divorce [@Tucker2008Enduring] and improvements in the welfare system for single-parent families [@Chiappori2006Divorce; @Herbst2016Mothers]
    - `INC_LOW` increased significantly between 2011 and 2016.


### Limitations and Motivations for Longitudinal analysis

**Challenges for Longitudinal Analysis**

- **Inconsistent Variable Selection**: The selection of variables for the index can vary across different years due to changes in data availability, definitions, or relevance.
    
- **Reference Value Shift**: The reference value of each variable may change over time due to shifts in data collection methods, definitions, or population characteristics.

- **Spatial Boundary Changes**: Changes in spatial boundaries, such as the merging or splitting of regions, can affect the comparability of data across years. Another issue that arises from the spatial boundary changes is the population distribution.

- **Standardization Issues**: The standardization of variables may vary across years due to changes in data collection methods or definitions. Inconsistent standardization can lead to discrepancies in the index's representation of socio-economic status over time.

- **Pattern Shift**: The underlying patterns of socio-economic status may shift over time due to changes in economic conditions, social policies, or population characteristics. In detail, some variables may have different importance in different years, which may lead to the different interpretation of the index.


**Motivations**

In response to these challenges, we aim to develop an index that can longitudinally capture socio-economic status variance in Australia

- **Consistency**: Based on the framework of the SEIFA as Australia provide one of the most comprehensive socio-economic indices with technical details and data availability and SEIFA is widely used in the research community with clear and transparent methodology

- **Comparability**: The new index LIRSD and WLIRSD should be able to comparing with the traditional widely used SEIFA index, and can be used to track the socio-economic status of areas over time

- **Secondary Finding**: Analysis the potential role of the second principal component of the constructed index


## Development of the Longitudinal IRSD (L-IRSD) and PC2 Index

**Trade-off between static and dynamic variable weights [@liborio2022principal]**

- **Single Indicator Approach**: A single weights is determined and applied across all time period, which prioritize comparability, assuming the importance of variable on SES remains stable.

- **Multiple Indicator Approach**: Weights are determined for each time period, which prioritize the capturing of the changing chracteristics of SES over time. But hard to compare the index across different time period.

- **Structured Indicator Approach**: This method was designed to maintain both dynamic socio-economic context representation and temporal comparability when comparing two time periods. When there are only two time periods, two indicators are created. The first indicator is constructed using PCA as usual, and the second indicator is built using the eigenvalue from the first PCA model and the standardized variables from the second period.

---
**Choose the Single Indicator Approach for L-IRSD**

- The ABS clearly adapted the **Multiple Indicator Approach** when producing SEIFA

- **Structured Indicator Approach** is not suitable here as when there are more than two time periods, the number of indicators will increase exponentially. And is is only recommended when the explained variance of the first principal component is greater than 50% [@liborio2022principal].

- We choose the **Single Indicator Approach** for the L-IRSD and WL-IRSD, as it aligns with our objective.


### Variable Selection for L-IRSD

<div style="font-size: 0.6em;">

| **Dimension** | **Variable**        | **06** | **11** | **16** | **21** | **W/LIRSD** |
|:---------------:|:-------------------|:------:|:------:|:------:|:------:|:---------:|
| **Income**      | INC_LOW            | -0.76  | -0.76  | -0.91  | -0.87  |           |
| **Education**   | NOQUAL              | -0.76  |        |        |        | Y         |
|                 | NOYR12ORHIGHER      |        | -0.75  | -0.77  | -0.75  |           |
|                 | NOSCHOOL            | -0.44  |        |        |        | Y         |
|                 | NOEDU               |        | -0.44  | -0.43  | -0.47  |           |
| **Employment**  | UNEMPLOYED          | -0.7   | -0.74  | -0.75  | -0.68  | Y         |
| **Occupation**  | OCC_LABOUR         | -0.76  | -0.75  | -0.74  | -0.68  | Y         |
|                 | OCC_DRIVERS        | -0.51  | -0.52  | -0.54  | -0.51  | Y         |
|                 | OCC_SERVICE_L     | -0.44  | -0.5   | -0.53  | -0.45  | Y         |
| **Housing**     | RENT_SOCIAL        | -0.7   |        |        |        |           |
|                 | LOWRENT             | -0.67  | -0.73  | -0.73  | -0.71  |           |
| **Miscellaneous** | NONET             | -0.85  | -0.81  | -0.79  |        |           |
|                 | ONEPARENT           | -0.67  | -0.71  | -0.67  | -0.58  | Y         |
|                 | DISABILITYU70       | -0.61  | -0.66  | -0.67  | -0.63  | Y         |
|                 | NOCAR               | -0.57  | -0.56  | -0.49  | -0.43  | Y         |
|                 | INDIGENOUS          | -0.52  |        |        |        |           |
|                 | OVERCROWD           | -0.52  | -0.52  | -0.46  | -0.51  |           |
|                 | DIVORCED            | -0.51  |        |        |        | Y         |
|                 | SEPDIVORCED         |        | -0.54  | -0.55  | -0.51  |           |
|                 | ENGLISHPOOR         | -0.33  | -0.34  | -0.3   | -0.35  | Y         |
|                 | CHILDJOBLESS        |        | -0.85  | -0.83  | -0.78  |           |
| **Total Number of Variables** |       | **17** | **16** | **16** | **15** | **11**    |

: List of Variables for Constructing IRSD across 2006-2021 {#tbl-variable-list}

</div>


Data obtained from *TableBuilder* from the ABS [@TableBuilder].

- `INC_LOW` and `LOWRENT` are excluded from as the reference value of these variables can not be customized in the *TableBuilder*

- `OVERCROWD` is excluded since it is not accessible in the 2006 and 2011

- `CHILDJOBLESS` is excluded since it is not accessible in the 2006

This careful exclusion strategy is essential to maintaining the index’s longitudinal consistency and robustness, even in light of certain data unavailability. Nevertheless, keeping there eleven variables in the L-IRSD ensures that the index remains comprehensive and representative of socio-economic status across different periods.


### Alignment of Geographic Boundaries

We align the raw (count) data from each census wave to the SA2 under the ASGS 2021. The conversion process is done by population-weighted average provided by correspondence files from ABS [@SEIFACorrespondences].

- Explicit guidelines are available for converting data from older geographical standards to the new framework, facilitated by a detailed correspondence table. 

- A significant objective of small area estimation research is to support forecasting the latest geographical standard allows for more accurate projections based on current data. This approach ensures that the L-IRSD is both historically consistent and relevant for future applications.

Exclusion rules after translating the original data to the SA2s under the ASGS 2021 framework

- Omitting areas where any variable has a denominator smaller than 6, which is a logical choice, mirroring the ABS’s own exclusion rule.


### Overall Procedure for Constructing L-IRSD

![Flowchart of constructing LIRSD and WLIRSD](notebooks/figures/steps.png){#fig-LIRSD-flowchart}


## Results of LIRSD and WLIRSD

Results will be analyzed in four aspects:

- **Proportion of Variation Explained**: The proportion of variation explained by the L-IRSD and WL-IRSD will be compared to the IRSD across different years.

- **Loading of Variables on PC1 and PC2**: The loadings of variables in the L-IRSD and WLIRSD will be compared to the IRSD across different years.

- **Cluster Analysis on areas based on PC1 and PC2**: The clustering of SA2s based on the PC1 and PC2 of the L-IRSD and WLIRSD will be compared to the IRSD across different years.

- **Comparison of (W)L-IRSD with IRSD and Trend Analysis**: The L-IRSD and WLIRSD will be compared to the IRSD across different years.


### Proportion of Variation Explained


```{r}
#| label: tbl-variationexplained
#| tbl-cap: "Proportion of Variation Explained by IRSD, LIRSD and WLIRSD"
#| echo: false         # Suppresses code display
#| warning: false      # Suppresses warnings
#| message: false      # Suppresses messages

# library packages
library(tidyverse)
library("FactoMineR")
library(matrixStats)
library(flextable)

# load data
PCA_Allin21 <- readRDS("data/A05_PCA_Allin21_new.RDS")
WPCA_Allin21 <- readRDS("data/A05_WPCA_Allin21_new.RDS")


# calculate the proportion of variation explained by IRSD, LIRSD and WLIRSD

FUN_var <- function(input_PCA) {
  pca_result <- input_PCA
  urp <- pca_result$call$row.w.init
  ind_sup <- pca_result$call$ind.sup
  X <- pca_result$call$X[-pca_result$call$ind.sup,] %>%
    as_tibble(rownames = NA) %>%
    mutate(Year = factor(Year)) %>%
    select(SA2_NAME21, Year, 
           DISABILITYU70, ENGLISHPOOR, NOCAR, NOEDU, NOYEAR12ORHIGHER, 
           OCC_DRIVERS, OCC_LABOUR, OCC_SERVICE_L, ONEPARENT, SEPDIVORCED,
           UNEMPLOYED) %>%
    bind_cols(URP = pca_result$call$row.w.init) %>%
    mutate(across(
      .cols = where(is.numeric) & !all_of("URP"),    # Exclude the weights column
      .fns = ~ {
        w_mean <- weighted.mean(., URP, na.rm = TRUE)    # Weighted mean
        w_sd <- sqrt(sum(URP * (. - w_mean)^2) / sum(URP))   # Weighted standard deviation
        (. - w_mean) / w_sd  # Scale by subtracting weighted mean and dividing by weighted SD
      },
      .names = "scaled_{.col}"  # Naming convention for the scaled columns
    ))
  
  X_var <- X %>%
    group_by(Year) %>%
    summarise(across(
      .cols = starts_with("scaled_"),
      ~ weightedVar(.,w = URP),
      .names = "weighted_var_{.col}"     # Rename the output columns
    )) %>%
    ungroup() %>%
    pivot_longer(
      cols = starts_with("weighted_var_"),
      names_to = "variable",
      values_to = "weighted_variance"
    ) %>%
    group_by(Year) %>%
    summarise(
      weighted_variance = sum(weighted_variance)
    )
  
  PC_var <- pca_result$ind$coord %>%
    as_tibble(rownames = NA) %>% 
    rename(PC1 = 1, 
           PC2 = 2,
           PC3 = 3,
           PC4 = 4,
           PC5 = 5) %>%
    bind_cols(X) %>%
    select(SA2_NAME21, URP, Year, PC1, PC2, PC3, PC4, PC5)  %>%
    group_by(Year) %>%
    summarise(across(
      .cols = starts_with("PC"),
      ~ weightedVar(.,w = URP),
      .names = "weighted_var_{.col}"     # Rename the output columns
    )) %>%
    ungroup() 
  
  var_ratio <- PC_var %>%
    left_join(X_var, by = "Year") %>%
    mutate(
      PC1 = weighted_var_PC1 / weighted_variance * 100,
      PC2 = weighted_var_PC2 / weighted_variance * 100,
      PC3 = weighted_var_PC3 / weighted_variance * 100,
      PC4 = weighted_var_PC4 / weighted_variance * 100,
      PC5 = weighted_var_PC5 / weighted_variance * 100
    ) %>%
    select(Year, PC1, PC2) %>%
    add_row(Year = "Overall",
            PC1 = pca_result$eig[1, 2],
            PC2 = pca_result$eig[2, 2])
}


# generate the table

tibble(Year = c("2006", "2011", "2016", "2021"),
                   PC1 = c(39, 44, 43, 37),
                   model = "IRSD") %>%
  bind_rows(FUN_var(PCA_Allin21) %>% 
  mutate(model = "LIRSD"),
  FUN_var(WPCA_Allin21) %>% 
              mutate(model = "WLIRSD")) %>%
  pivot_longer(
    cols = c(PC1, PC2),
    names_to = "PC",
    values_to = "VarExplained"
  ) %>%
  mutate(PC = if_else(PC=="PC1", "", "-PC2"),
         var = str_c(model, PC)) %>%
  select(-PC, -model) %>%
  pivot_wider(
    names_from = var,
    values_from = VarExplained
  ) %>%
  select(Year, IRSD, LIRSD, WLIRSD, `LIRSD-PC2`, `WLIRSD-PC2`) %>%
  flextable(.) %>%
  colformat_double(j = 3:6,
                   digits = 2,
                   suffix = "%") %>%
  colformat_double(j = 2,
                   digit = 0,
                   suffix = "%") %>%
  fontsize(size = 20) %>%
  fontsize(size = 20, part = "header") %>%
  bold(part = "header") %>%   
  padding(padding = 12) %>%
  autofit()
```

- `WLISD` show a higher proportion of variation explained by PC1 compared to `L-IRSD` and `IRSD` across different years, which is consistent with the expectation that the weighted index should better capture the socio-economic status of the areas.

- The proportion of variation explained by PC2 around 20% in `L-IRSD` and `WLIRSD` across different years, which reveals the potential of PC2 in capturing the socio-economic status of the areas.

- The higher value within each year compared to the overall value make sense as the they may have same pattern within each year, but different pattern across different years.


### Loading of Variables on PC1 and PC2

::: {#fig-PCA-var layout-ncol=2}

![](notebooks/figures/PCA/A06_PCA_Var.png){#fig-LIRSD-var}

![](notebooks/figures/PCA/B06_WPCA_Var.png){#fig-WLIRSD-var}

Correlation Circle of Variables on PC1 and PC2 for L-IRSD and WLIRSD
:::

- **Orthogonal Relationship**: PC2 is always orthogonal to PC1, which means that the interpretation of PC2 should be somewhat independent of PC1.

- **PC1 Loading**
    - All loadings are in the same direction, which is good for the interpretation of the index.
    - The variables `OCC LABOUR`, `ONEPARENT`, and `DISABILITYU70` show the highest loadings. This is followed closely by
`UNEMPLOYED` and occupation-related variables like `OCC_DRIVERS` and `OCC_SERVICE_L`.
    - `NOYEAR12ORHIGHER` and `NOEDU` are moderate
    - `ENGLISHPOOR` and `NOCAR` have the lowest loadings

- **PC2 Loading**
    - Some loading are in opposite direction with each other, however, there are **clusters** of variables that have similar loading patterns.
    -  `ENGLISHPOOR` and `NOCAR` cluster together, revealing a lifestyle or demographic grouping where English proficiency and vehicle ownership are common attributes
    - `ONEPARENT`, `SEPDIVORCED`, and `DISABILITYU70` cluster together, indicating a socio-economic grouping where single-parent families, divorced individuals, and those with disabilities are prevalent
    - The above two clusters are in opposite direction in PC2, which means that there are two different types of disadvantage in the socio-economic status occurs in different areas
    - The diverse between `NOEDU` and `NOYEAR12ORHIGHER` is also interesting, indicating the lack of different level of education may refers to different types of disadvantage in the socio-economic status


### Cluster Analysis on areas based on PC1 and PC2

::: {#fig-PCA-ind layout-ncol=2}

![](notebooks/figures/PCA/A06_PCA_Ind.png){#fig-LIRSD-ind}

![](notebooks/figures/PCA/B06_WPCA_Ind.png){#fig-WLIRSD-ind}

Scatter plot of PC1 and PC2 of Observations across SA2s for L-IRSD and WLIRSD
:::

- **SA2s with High Contribution to PC1:** In PCA analysis, high contribution of PC1 on units means this units was represented by the PC1 well, which we highlight them with label on @fig-LIRSD-ind and @fig-WLIRSD-ind
    
    - **TYPE 1:** Functional areas of urban centers, with high proportion of certain occupations and low educational attainment
    
    *Elizabeth*, *Smithfield - Elizabeth North*, *Bridge - Gagebrook* and *Logan Central*
    
    - **TYPE 2:** Areas with high proportion of first nations people with unique cultural and social characteristics
    
    *Yarrabah*, *East Arnhem*, *Yuendumu - Anmatjere* and *Sandover - Plenty*
    
    - **TYPE 3:** Areas with high proportion of immigrants with low English proficiency and car ownership
    
    *Cabramatta-Lansvale*, *Inala - Richlands*, *Ashcroft - Busby - Miller*, *Smithfield - Elizabeth North*, and *Davoren Park*

- **Capital vs. Non-Capital areas**
    - Both capital and non-capital areas spread across different levels of PC1, indicating that disadvantage is not limited to only capital or only non-capital areas
    
    - However, capital areas tend to have higher PC2 values, indicating a different type of disadvantage compared to non-capital areas
    
    - Also, this founding enlighten the importance of PC2 in capturing the urban-rural differences in socio-economic status


### Comparison of (W)L-IRSD with IRSD and Trend Analysis

::: {#fig-PCA-compare layout-ncol=2}

![](notebooks/figures/PCA/A07_ScoreCompar_SA2.png){#fig-LIRSD-compare}

![](notebooks/figures/PCA/B07_ScoreCompar_SA2_WPCA.png){#fig-WLIRSD-compare}

Scatter between IRSD and L-IRSD, WLIRSD at SA2
:::

- Diagonal line represents the scores of IRSD and (W)L-IRSD are the same, and the points above the line means the score of (W)L-IRSD are higher than IRSD, and the points below the line means the score of (W)L-IRSD are lower than IRSD

- **Convergence vs. Divergence**
    
    - Trend lines of both capital and non-capital areas nearly converge with diagnal in 2006, but become more and more divergent as time goes on
    
    - The flattening of trend lines for non-capital areas suggests that, although these areas still face socio-economic challenges, their level of disadvantage has decreased over time—reflected in improved scores when considered longitudinally.
    
    - The sharpening of trend lines for capital areas suggests that the socio-economic status of these regions has become increasingly polarized over time, with some areas showing notable improvement while others have declined.
    

**Trend Analysis**

::: {#fig-PCA-trend layout-ncol=2}

![](notebooks/figures/PCA/A07_ScoreCompar_GCC.png){#fig-LIRSD-trend}

![](notebooks/figures/PCA/B07_ScoreCompar_GCC_WPCA.png){#fig-WLIRSD-trend}

Parallel Coordinate Plot of IRSD and (W)LIRSD for Greater Capital Cities (GCC) over Years
:::

- In ACT and Greater Sydney, there is a modest decline in the IRSD, which is not mirrored
in the (W)LIRSD scores, indicating that the socio-economic status of these areas has improved over time, but the relative level within each time period declined

- In non-capital areas of NT, there is decreasing trend in the IRSD, but increasing trend in the (W)LIRSD, indicating that the socio-economic status of these areas has improved over time, and the relative level within each time period became worse (other areas improved more than these areas)


## Applications

- Not only the (W)LIRSD, but also the PC2 of each of them can be used as covariates in the models.

- There are two series of models can be built:

    - **Spatial Models within one period**: 
    
    We want to explore the validity of the (W)LIRSD and PC2 in capturing the socio-economic status of areas within one period. The (W)LIRSD will be used as a covariate in the models comparing to use the IRSD. The PC2 will be used as a covariate in the models comparing to use the ARIA index.
    
    - **Spatio-Temporal Models across four period**:
    
    We want to validate the (W)LIRSD on capturing the socio-economic status of areas across different periods. The (W)LIRSD will be used as a covariate in the models comparing to use the IRSD. No other covariates will be used in the models.


### Data

Other than IRSD and (W)LIRSD, two other datasets will be used in the models.

- **The Australia Early Development Census (AEDC)**: The AEDC is a national census of early childhood development in Australia. It provides a snapshot of how children have developed by the time they start their first year of full-time school. It is conducted every three years from 2009, and consists of five domains: `physical health and well-being`, `social competence`, `emotional maturity`, `language and cognitive skills`, and `communication skills and general knowledge`.

- **Accessibility/Remoteness Index of Australia (ARIA)**: The ARIA is a measure of the relative access to services in different parts of Australia. It is based on the road distance to different types of services, such as hospitals, schools, and shopping centers. The ARIA can be grouped into five categories: `major cities`, `inner regional`, `outer regional`, `remote`, and `very remote`. However, in this study, we will use the continuous ARIA index in 2016.


### Model Comparison I: Spatial Models within one period

**Model specification**

Following the methodologies of @cramb2018investigation, @li2020bayesian, and @mollie1996bayesian, this study applies a **Bayesian hierarchical model** to smooth observed estimates of childhood vulnerability. This model is specifically designed to account for socio-economic disparities, spatial variations, and unobserved factors that may affect estimate accuracy. We choose **Leroux spatial model** as the spatial structure in the model, which is a popular choice in spatial modeling due to its flexibility and computational efficiency [@leroux2000estimation].

**Model development**

```{=latex}
\begin{align*}
    M1: logit(\mathbf{p}) &= \beta_0 + \beta_1 \mathbf{x}_{IRSD} + \mathbf{\phi}\\
    M2: logit(\mathbf{p}) &= \beta_0 + \beta_1 \mathbf{x}_{IRSD} + \beta_2 \mathbf{x}_{ARIA} + \mathbf{\phi}\\
    M3: logit(\mathbf{p}) &= \beta_0 + \beta_1 \mathbf{x}_{L-IRSD} + \mathbf{\phi}\\
    M4: logit(\mathbf{p}) &= \beta_0 + \beta_1 \mathbf{x}_{L-IRSD} + \beta_2 \mathbf{x}_{L-IRSD-PC2} + \mathbf{\phi}
\end{align*}
```


**Model fit results**

<div style="font-size: 0.55em;">

| **Variable**      | **M1 %Mean** | **M1 t-value** | **M2 %Mean** | **M2 t-value** | **M3 %Mean** | **M3 t-value** | **M4 %Mean** | **M4 t-value** |
|---------------|-----|-----|-----|-----|-----|-----|-----|-----|
| **Coefficients of Fixed Effects** |  |  |  |  |  |  |  |  |
| (Intercept)      | 291.34       | **7.45**      | 312.74       | **7.65**      | 136.15       | **4.79**      | 305.92       | **8.82**      |
| IRSD             | -0.54        | **-13.78**    | -0.56        | **-13.9**     |              |                |              |               |
| L-IRSD           |              |               |              |               | -0.39        | **-13.58**    | -0.36        | **-13.54**    |
| ARIA             |              |               | -0.87        | -0.85         |              |                |              |               |
| L-IRSD-PC2       |              |               |              |               |              |                | -0.2         | **-7.74**     |
| **Parameters in Random Effects** |  |  |  |  |  |  |  |  |
| $\tau^2$         | 20.78        | **8.12**      | 20.96        | **8.12**      | 23.65        | **8.32**      | 19.79        | **8.47**      |
| $\rho$           | 68.43        | **6.23**      | 70.59        | **6.57**      | 73.49        | **7.31**      | 78.78        | **8.7**       |
| **Information Criteria** |  |  |  |  |  |  |  |  |
| DIC \& $p_d$     | 2477.9       | 241.79        | 2477.08      | 240.6         | 2476.91      | 244.8         | **2466.41**  | **232.95**    |
| WAIC \& $p_w$    | 2459.26      | 164.78        | 2458.91      | 164.39        | 2454.91      | 164.3         | **2449.42**  | **160.03**    |
| LMPL \& loglik   | -1329.61     | -997.16       | -1321.95     | -997.94       | -1329.29     | **-993.65**   | **-1310.09** | -1000.25      |
| LOOIC            | 2602.21      |               | 2599.71      |               | 2599.96      |               | **2583.77**  |               |
| ELPD             | -1301.1      |               | -1299.85     |               | -1299.98     |               | **-1291.88** |               |

: Estimated regression coefficient, standard deviation parameter, and model information criteria (DIC, WAIC, LOOIC, ELPD) for the developed models M1 to M4 for prevalence of vulnerability in **Communication Skills and General Knowledge** domain {#tbl-model-01-communication}

</div>


- All models were fitted for each of the five AEDC domains, with the best results occurring in the Communication Skills and General Knowledge domain, as shown in @tbl-model-01-communication.

- The results indicate that the (W)LIRSD and PC2 are stronger predictors of childhood vulnerability than the IRSD and ARIA, as reflected by lower DIC, WAIC, and LOOIC values.

- PC2 is more significant in the model than ARIA, suggesting that PC2 may be a more suitable covariate for remoteness. This may be because ARIA is skewed toward major cities, whereas PC2 is more evenly distributed across different levels.


**Variance and bias trade-off by Taylor Diagram**

![Taylor diagrams of estimations in prevalence of childhood developmentally vulnerability in Communication Skills & General Knowledge domain by SA3 in Capital and Non-Capital regions](notebooks/figures/Model_01/Figure_Taylor_Communication.png){#fig-LIRSD-model01 width=80%}

- Combination of (W)LIRSD and PC2 as predictors in the model works best in terms of lower variations while still achieving strong correlation with the observed data on non-capital areas


### Model Comparison II: Spatio-Temporal Models on multiple periods

**Model specification**

As AEDC is not always matched with the census year, when the spatio-temporal models was built, the IRSD and (W)LIRSD will be used as applied the cubic spline interpolation to the time variable from 2006 to 2021 to match them with the AEDC data in 2009, 2012, 2015, 2018 and 2021.

The Bayesian hierarchical model with spatio-temporal structured random effects will be used to on small area estimation on childhood vulnerability. Random effect will be decomposed into three components: spatially structured, temporally structured, and unstructured random effects [@knorr2000bayesian].

**Model development**

```{=latex}
\begin{align*}
    M1: logit(p_{k,t}) &= \beta_0 + \beta_1 \mathbf{x}_{IRSD,k,t} + \mathbf{\phi_k} + \mathbf{\psi_t} + \mathbf{\epsilon_{k,t}} \\
    M2: logit(p_{k,t}) &= \beta_0 + \beta_1 \mathbf{x}_{L-IRSD,k,t} + \mathbf{\phi_k} + \mathbf{\psi_t} + \mathbf{\epsilon_{k,t}} \\
    M3: logit(p_{k,t}) &= \beta_0 + \beta_1 \mathbf{x}_{L-IRSD,k,t} + \beta_2 \mathbf{x}_{L-IRSD-PC2,k,t} + \mathbf{\phi_k} + \mathbf{\psi_t} + \mathbf{\epsilon_{k,t}}
\end{align*}
```

**Model fit results**

<div style="font-size: 0.55em;">

| **Variable**      | **M1 %Mean** | **M1 t-value** | **M2 %Mean** | **M2 t-value** | **M3 %Mean** | **M3 t-value** |
|---------------|-----|-----|-----|-----|-----|-----|
| **Coefficients of Fixed Effects** |  |  |  |  |  |  |
| (Intercept)      | 222.44       | **8.02**      | 161.42       | **7.84**      | 307.42       | **11.56**      |
| IRSD             | -0.47        | **-16.9**     |              |               |              |                |
| L-IRSD           |              |               | -0.41        | **-19.88**    | -0.39        | **-20.12**     |
| L-IRSD-PC2       |              |               |              |               | -0.16        | **-7.29**      |
| **Parameters in Random Effects** |  |  |  |  |  |  |
| $\tau^2_{Sp}$    | 14.97        | **9.28**      | 16.19        | **9.91**      | 12.22        | **9.34**       |
| $\tau^2_{Te}$    | 0.6          | 1.15          | 0.85         | 1.3           | 0.89         | 1.32           |
| $\tau^2_{Ind}$   | 2.45         | **13.15**     | 2.16         | **12.52**     | 2.25         | **13.17**      |
| $\rho_{Sp}$      | 83.1         | **11.26**     | 85.32        | **12.75**     | 88.23        | **14.87**      |
| $\rho_{Te}$      | 49.94        | 1.92          | 49.39        | 1.89          | 48.45        | 1.85           |
| **Information Criteria** |  |  |  |  |  |  |
| DIC \& $p_d$     | 12125.02     | 1002.82       | 12100.06     | 967.12        | **12091.55** | 970.54         |
| WAIC \& $p_w$    | 12075.75     | 716.76        | 12065.82     | 704.28        | **12047.43** | 699.27         |
| LMPL \& loglik   | -6351.53     | -5059.69      | -6311.2      | -5082.91      | **-6297.64** | -5075.24       |
| LOOIC            | 34460.99     |               | **33756.56** |               | 33987.54     |                |
| ELPD             | -17230.5     |               | **-16878.3** |               | -16993.8     |                |

: Estimated regression coefficient, standard deviation parameter, and model information criteria (DIC, WAIC, LOOIC, ELPD) for the developed models M1 to M4 for prevalence of vulnerability in **Communication Skills and General Knowledge** domain {#tbl-model-02-communication}

</div>

- We only show the results of the Communication Skills and General Knowledge domain in @tbl-model-02-communication, and the results of other domains are similar

- (W)LIRSD works better than IRSD, while the combination of (W)LIRSD and PC2 works the best

- This may be because the (W)LIRSD and PC2 are more sensitive to the socio-economic status of the areas in different periods than the IRSD


**Variance and bias trade-off by Taylor Diagram**

![Taylor diagrams of estimations in prevalence of childhood developmentally vulnerability in Communication Skills & General Knowledge domain by SA3 in Capital and Non-Capital regions](notebooks/figures/Model_02/I02_Fig_Taylor_Communication.png){#fig-LIRSD-taylor-model02 width=80%}

- The combination of (W)LIRSD and PC2 as predictors in the model works best in terms of lower variations while still achieving strong correlation with the observed data on non-capital areas

**Trend Analysis**

![Trends in prevalence of childhood developmentally vulnerability in Physical Health & Wellbeing and Communication Skills & General Knowledge domains by Greater Capital City Statistical Area (GCCSA)](notebooks/figures/Model_02/F02_Fig_Trend_GCC.png){#fig-LIRSD-trend-model02-all width=70%}

![Trends in prevalence of childhood developmentally vulnerability in Physical Health & Wellbeing and Communication Skills & General Knowledge domains by Greater Capital City Statistical Area (GCCSA)](notebooks/figures/Model_02/F02_Fig_Trend_SA3_ACT.png){#fig-LIRSD-trend-model02-act width=70%}

**Annual Percentage Change**

<div style="font-size: 0.55em;">

| **Region**                       | **2015 - 2018 APC** | **t-value** | **LL**  | **UL**  | **2018 - 2021 APC** | **t-value** | **LL**  | **UL**  |
|:---------------------------------|:-----------------:|:-------:|:-------:|:-------:|:-----------------:|:-------:|:-------:|:-------:|
| Australian Capital Territory     | -0.03              | -0.02       | 3.39    | -3.37   | 3.53                 | **2.13**    | 6.78    | 0.28    |
| Greater Adelaide                 | 0.10               | 0.10        | 2.21    | -1.99   | 0.45                 | 0.43        | 2.51    | -1.55   |
| Greater Brisbane                 | -1.05              | -1.59       | 0.24    | -2.36   | -2.34                | **-3.44**   | -1.02   | -3.68   |
| Greater Darwin                   | -1.81              | -0.73       | 3.00    | -6.77   | 8.69                 | **3.60**    | 13.34   | 3.83    |
| Greater Hobart                   | -2.08              | -0.90       | 2.41    | -6.59   | 0.21                 | 0.09        | 4.82    | -4.30   |
| Greater Melbourne                | -1.32              | **-2.10**   | -0.07   | -2.57   | 0.80                 | 1.29        | 2.02    | -0.41   |
| Greater Perth                    | -3.51              | **-4.04**   | -1.82   | -5.26   | 3.00                 | **3.40**    | 4.76    | 1.30    |
| Greater Sydney                   | -0.57              | -1.02       | 0.52    | -1.65   | 0.90                 | 1.62        | 2.00    | -0.16   |
| Rest of NSW                      | -0.87              | -1.21       | 0.54    | -2.26   | 2.08                 | **2.90**    | 3.47    | 0.70    |
| Rest of NT                       | 1.53               | 0.71        | 5.69    | -2.72   | -3.63                | -1.60       | 0.82    | -8.06   |
| Rest of Qld                      | -1.10              | -1.69       | 0.19    | -2.36   | -1.48                | **-2.22**   | -0.17   | -2.79   |
| Rest of SA                       | 0.95               | 0.58        | 4.11    | -2.31   | 0.03                 | 0.02        | 3.30    | -3.21   |
| Rest of Tas.                     | -4.19              | **-2.06**   | -0.26   | -8.24   | 5.30                 | **2.57**    | 9.36    | 1.33    |
| Rest of Vic.                     | 0.18               | 0.19        | 2.10    | -1.71   | -0.99                | -0.99       | 0.98    | -2.91   |
| Rest of WA                       | -2.30              | -1.74       | 0.23    | -4.86   | 2.61                 | 1.93        | 5.30    | 0.00    |

: Annual percentage change (APC) estimated by M3 in the prevalence of childhood developmentally vulnerability in Communication Skills & General Knowledge
in Australia by Greater Capital City Statistical Area. LL and UL denote for the lower and
upper limits of 95% credibility interval respectively. Significant changes (with |t| > 2.00)
are shown in bold. {#tbl-model-02-apc}

</div>


**Mapping of significant changes**

![The map displays the significant and insignificant changes in prevalence of
vulnerability in Communication Skills & General Knowledge across Australia and
capital regions at Statistical Area level 3 (SA3) from 2018 to 2021. SA3s with significant
increases or decreases are labeled. The statistical significance of the APC calculated on
95% credibility level.](notebooks/figures/Model_02/H03_Map_Communication_APC_2018-2021.png){#fig-LIRSD-map-model02 width=100%}


## Conclusion on Part One

- A historical review of the ABS's IRSD reveals shifts in the socio-economic status norms of areas over time, captured by tracking variable loadings on the IRSD

- The new index, (W)LIRSD, effectively captures changes in socio-economic status over time and reveals different types of socio-economic disadvantage by incorporating PC2

- The combination of (W)LIRSD and PC2 serves as a better predictor of childhood vulnerability than IRSD and ARIA, demonstrating the new index's effectiveness in capturing socio-economic status in applications

- The spatio-temporal models indicate that (W)LIRSD is more sensitive to socio-economic status across different periods than IRSD. The combination of (W)LIRSD and PC2 performs even better, demonstrating the new index's ability to capture socio-economic status variations over time in applications


# Part Two: Bivariate Bayesian Hierarchical Modeling with Copula-based Spatial Dependence Using Conditional Autoregressive Frameworks

## Backgrounds

- Disease mapping has become a critical tool for identifying high-risk areas, tracking disease trends, and understanding disparities within and across populations, which requires the development of spatial models [@persaud2021united].

- **Bayesian hierarchical models** (BHMs) are a popular choice for disease mapping due to their ability to account for spatial dependence, unobserved heterogeneity, and measurement error. However, bivariate BHMs are less common, despite the importance of understanding the relationship between two diseases or health outcomes.
    - The **spatial dependence** in BHMs is often modeled using conditional autoregressive (CAR) priors, as it assumes that near things are more related.
    - The **copula** function is used to model the joint distribution of two random variables, which can capture the dependence structure between the two variables. Traditional spatial models only use bivariate normal distribution to model the joint distribution, which may not be flexible enough to capture the complex dependence structure between two diseases [@nelsen2006introduction].


## Reviews on Bivariate BHMs, Spatial Dependence, and Copula Functions

- **Bayesian Hierarchical Models (BHMs)**: Bayesian models can be complex and flexible (than frequentest models) as they can incorporate prior information, can (always) be fitted by Markov Chain Monte Carlo (MCMC) methods.

- **Spatial Effects and CAR Priors**: Spatial effects are the effects of the location of the area on the outcome, where near areas are more related. The CAR prior is a popular choice for spatial effects in BHMs, as it can capture the spatial dependence between areas by assuming the conditional distribution of the outcome in one area depends on the outcomes in neighboring areas.

- **Copulas**: Copulas are a powerful tool for modeling the joint distribution of two or more random variables by decoupling the marginal distributions from the dependence structure.


### Bayesian Hierarchical Models

- The Bayesian models assumes the parameters in the model are random variables, and the prior distribution of the parameters are specified. The posterior distribution of the parameters can be obtained by Bayes' theorem, and the MCMC methods can be used to sample from the posterior distribution.

- The hierarchical structure in the model allows the parameters to vary across different levels, where the prior of the former level is the posterior of the latter level

    - **Data Layer**: Observed data are modeled as random variables conditional on the parameters
    - **Process Layer**: Parameters from the data layer are modeled as random variables conditional on their own distributions. This layer can be hierarchically structured to capture different levels of variation in the data
    - **Prior Layer**: Priors of the parameters in the process layer are specifed through hyperparameters, which can be fixed or random variables themselves.

**Formula of Bayesian Hierarchical Models in General**
$$
  y_i | \mu_i \sim \mathcal{D}(Y_i | \mu_i)
$$
$$
  \quad g(\mu_i) = \boldsymbol{x}_i^\top \boldsymbol{\beta} + \epsilon_i 
$$
$$
  \boldsymbol{\beta} \sim \text{Gaussian}(\boldsymbol{\mu_{\beta}}, \boldsymbol{\Sigma_{\beta}}) \quad \text{and} \quad \boldsymbol{\epsilon} \sim \mathcal{D_{\epsilon}}(\dots)
$$

![Diagram of a Bayesian hierarchical model in general form](notebooks/figures/bhm/dot-figure-1.png){#fig-bhm-general width=75%}


### Spatial Effects and CAR Priors

#### Spatial Effects

- **Neighborhood matrix**: The spatial structure of the data can be represented by a neighborhood matrix, where the elements of the matrix indicate whether two areas are neighbors or not.

- **Spatial autocorrelation**: The spatial autocorrelation is the correlation between the outcomes and its neighbors (named spatial lag), which can be captured by the CAR prior.

![Prevalence of Vulnerability in Physical Health and Wellbeing in Greater Sydney by SA3, 2021](notebooks/figures/spatial/fig-syd-lisa-sa3-1.png){#fig-spatial-lisa}

- **Spatial autocorrelation in models**: The spatial autocorrelation occurs in the residuals of the model, shows the remaining spatial effects that can not be caputred by the covariates in the model

::: {#fig-spatial-res layout-ncol=1}
![Spatial Distribution of the Prevalence of Vulnerability in Physical Health and Wellbeing of Dhildren and IRSD in Greater Sydney by SA3, 2021](notebooks/figures/spatial/fig-spatial-aedc-irsd-sa3-1.png){#fig-spatial-aedc-irsd}

![Conmparison of Residuals and Spatial Lag of Residuals of Vulnerability in Physical Health and Wellbeing of Children in Australia by SA3, 2021](notebooks/figures/spatial/fig-spatial-residuals-sa3-1.png){#fig-spatial-residuals}

Spatial Distribution of the Prevalence of Vulnerability in Physical Health and Wellbeing of Children and IRSD, and their residuals with spatial lag in Greater Sydney by SA3, 2021
:::

#### Conditional Autoregressive (CAR) Priors

- The CAR prior is a popular choice for spatial effects in BHMs, as it can capture the spatial dependence between areas by assuming the conditional distribution of the outcome in one area depends on the outcomes in neighboring areas.

- The structure of the CAR prior is not unique, and it can be defined based on the neighborhood matrix of the data. The most common CAR prior are Intrinsic Conditional Autoregressive (ICAR) and Besag-York-Mollie (BYM), and **Leroux prior** [@leroux2000estimation].

- Brook's Lemma help with converting conditional distribution to joint distribution, which is the key for CAR model to be fit [@brook1964distinction].


### Copulas

- **Copulas** are a powerful tool for modeling the joint distribution of two or more random variables by decoupling the marginal distributions from the dependence structure 

- Different choice of copulas can capture different types of dependence structure, such as Gaussian copula Clayton copula, and Gumbel copula [@genest1993statistical]

- Dependence structure, not only the correlation, but also the shape (asymmetric or symmetric) and the tail (heavy or light) of the joint distribution 

![Copula Density for Frank, Clayton, Gumbel and Joe copulas](notebooks/figures/copula/fig-copula-archimedean-1.png){#fig-copula-archimedean}

![Residuals and Empirical Copulas of Residuals of Vulnerability in Social Competence and Language and Cognitive Skills](notebooks/figures/copula/fig-empirical-copula-1.png){#fig-copula-res}

## Model Development - Bivariate Bayesian Hierarchical Models with Copula-based Spatial Dependence

- New model was developed based on the framework of bivariate Bayesian hierarchical models with Leroux spatial structure, can be denoted as **"Cop-leroux model"**, we only show model specification briefly here.

- The model can be fitted by MCMC methods, and random effects can be simulated by Gibbs sampling. The algorithm will not be shown here.

- R Package `CARBayesCopula` was established and public available on GitHub for convenient install. The core algorithm of the model was written in `Rcpp` for computational efficiency


### Model Specification

:::{#fig-bhm-bivariate layout-ncol=2}

![Diagram of Bivariate Leroux Model](notebooks/figures/bhm/dot-figure-3.png){#fig-bhm-leroux width=70%}

![Diagram of Bivariate Copula-based Leroux Model](notebooks/figures/bhm/dot-figure-2.png){#fig-bhm-copleroux}

Diagram of Bivariate Leroux Model and Copula-based Leroux Model
:::

### R Package `CARBayesCopula`


- The R package `CARBayesCopula` is a flexible and efficient tool for fitting bivariate Bayesian hierarchical models with copula-based spatial dependence using the Leroux spatial structure. It was developed based the framework of `CARBayes` package [@lee2013carbayes]

- The core simulation algorithm is written in `Rcpp` [@eddelbuettel2011rcpp] for computational efficiency, and the package provides functions for model diagnostics in LOOIC [@vehtari2020loo], DIC, and WAIC.

- The choice of copula function are "Gaussian", "Clayton", "Gumbel", "Frank" and "Joe". 

- Open to public by GitHub (and CRAN after the review)

[https://github.com/MoooooLee/CARBayesCopula](https://github.com/MoooooLee/CARBayesCopula)


## Applications























# Appendix {.unnumbered}

### PCA steps {.unnumbered}

PCA is a statistical method that can be used to reduce the dimensional of a dataset by transforming the data into a new set of uncorrelated variables called principal components.

1. Standardize the data
$$
        Z_{i,j} = \frac{Y_{i,j} - \bar{y}_{j}}{s_j}
$$

    In the case of PCA with weights, the standardized value need to be weighted by the corresponding weight, where the mean and standard deviation are calculated based on the weighted data. Here we list the simple formula for the weighted mean and standard deviation. 
$$
    \bar{y}_{j} = \frac{\sum_{i=1}^{n} w_i Y_{i,j}}{\sum_{i=1}^{n} w_i} \quad \quad s_{j} = \sqrt{\frac{\sum_{i=1}^{n} w_i (Y_{i,j} - \bar{y}_{j})^2}{\sum_{i=1}^{n} w_i}}
$$ 

2. Calculate the covariance matrix

    The empirical covariance matrix $\mathbf{C}$ is a $p \times p$ matrix that captures the pairwise relationships between variables. 
    In the case of PCA with weights, the covariance matrix is computed based on the weighted standardized data:
$$
    C_{j,k} = \frac{1}{\sum_{i=1}^{n} w_i} \sum_{i=1}^{n} w_i Z_{i,j} Z_{i,k}
$$

3. Eigenvalue Decomposition

    The third step in PCA is to perform an eigenvalue decomposition of the covariance matrix. The eigenvalue decomposition of the covariance matrix $\mathbf{C}$ yields a set of eigenvectors and eigenvalues. The eigenvectors represent the directions of maximum variance in the data, while the eigenvalues represent the amount of variance explained by each eigenvector. The eigenvectors are arranged in descending order based on their corresponding eigenvalues. Here we denote the $k$th eigenvector as $\mathbf{v}_{k}$, and the $k$th eigenvalue is denoted as $\lambda_{k}$.

4. Principal Component Scores

    The fourth step in PCA is to compute the principal component scores. The principal component scores represent the linear combinations of the original variables that capture the maximum amount of variance in the data. The $k$th principal component score for the $i$th observation can be calculated as: 
$$
    PC_{i,k} = \sum_{j=1}^{p} \alpha_{j,k} Z_{i,j}
$$

    where $\alpha_{j,k}$ is the loading of the $j$th variable on the $k$th principal component, can be calculated from the eigenvectors and eigenvalues. The formula for the loading is: 
$$
    \alpha_{j,k} = \sqrt{\lambda_{k}} v_{j,k}
$$ 

    where $v_{j,k}$ is the $j$th element of the $k$th eigenvector and the $\lambda_{k}$ is the $k$th eigenvalue as we mentioned in the previous step.


### Taylor Diagram {.unnumbered}

The trade-off between variance and bias can be always the key point in the model estimation. The Taylor diagram is a graphical method to visualize the trade-off. The good estimation should have lower variance and bias, where the estimation should have high correlation with the observed data.

High variation with no bias may indicate that the model is overfitting the data, while low variation with high bias may indicate that the model is underfitting the data.

![Taylor Diagram on Simulated Data](notebooks/figures/Model_01/H02_TaylorDiagram_Example.png){#fig-taylor-example}

As we can see that model A should be the worst model, as it just predict the mean of the data, which has no variance but high bias. Model D faces the overfitting issue, as it has high variance but low bias. Model B and C are the good models, as they have lower variance and bias, and high correlation with the observed data.


### Model Specification of Cop-leroux {.unnumbered }

**Bivariate copula-based Leroux model with binomial data layer**

A bivariate copula-based Leroux model with the binomial data layer can be described as the following set of equations.

<div style="font-size: 0.6em;">

\begin{align}
    \boldsymbol{y_A} \sim Bin(\boldsymbol{n_A}, \boldsymbol{p_A}) \quad &\text{and} \quad \boldsymbol{y_B} \sim Bin(\boldsymbol{n_B}, \boldsymbol{p_B}) \\
    logit(\boldsymbol{p_A}) = \boldsymbol{X}\boldsymbol{\beta_A} + \boldsymbol{\epsilon_A} \quad &\text{and} \quad logit(\boldsymbol{p_B}) = \boldsymbol{X}\boldsymbol{\beta_B} + \boldsymbol{\epsilon_B} \\
    (\boldsymbol{\epsilon_A, \boldsymbol{\epsilon_B}}) &= (\boldsymbol{\phi_A}, \boldsymbol{\phi_B})\\
    \boldsymbol{\phi_A} | \rho, \phi_{A,-j}, \boldsymbol{W}, \tau_A &\sim N \left( \frac{\rho \sum_{i=1}^{K}w_{ji} \phi_{A,i}}{\rho \sum_{i=1}^{K}w_{ji} +1-\rho}, \frac{\tau_A^2}{\rho \sum_{i=1}^{K}w_{ji} +1-\rho} \right) \\
    \boldsymbol{\phi_B} | \rho, \phi_{B,-j}, \boldsymbol{W}, \tau_B &\sim N \left( \frac{\rho \sum_{i=1}^{K}w_{ji} \phi_{B,i}}{\rho \sum_{i=1}^{K}w_{ji} +1-\rho}, \frac{\tau_B^2}{\rho \sum_{i=1}^{K}w_{ji} +1-\rho} \right) \\
    (\boldsymbol{\phi_A}, \boldsymbol{\phi_B}) | \alpha &\sim Cop(\boldsymbol{\phi_A}, \boldsymbol{\phi_B}, C(\alpha))\\
\end{align}

</div>


Here $\boldsymbol{y_A}$ and $\boldsymbol{y_B}$ represent the observed data for the two components of the bivariate model, with $\boldsymbol{n_A}$ and $\boldsymbol{n_B}$ as the corresponding trial numbers. The probability vectors $\boldsymbol{p_A}$ and $\boldsymbol{p_B}$ are modeled using logit link functions with covariates $\boldsymbol{X}$ and regression coefficients $\boldsymbol{\beta_A}$ and $\boldsymbol{\beta_B}$, respectively.


The random effects $\boldsymbol{\epsilon_A}$ and $\boldsymbol{\epsilon_B}$ are assumed to be determined by the structured components $\boldsymbol{\phi_A}$ and $\boldsymbol{\phi_B}$, which are modeled as conditional autoregressive (CAR) effects. The marginal distributions of the structured components are assumed to follow normal distributions with spatial dependencies captured by the spatial dependence parameter $\rho$, the neighborhood matrix $\boldsymbol{W}$, and the precision parameters $\tau_A$ and $\tau_B$. While the joint distribution of the structured components is modeled using a copula function $C(\alpha)$, with $\alpha$ representing the copula parameter.


## References {.unnumbered}

::: {#refs}
:::

